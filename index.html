<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Google Sheets Data Parser</title>
    <!-- Include the Google API JavaScript library -->
    <script src="https://apis.google.com/js/api.js"></script>
    <style>
      /* Add any necessary CSS styles here */
    </style>
  </head>
  <body>
    <!-- Your HTML elements for displaying parsed data go here -->

    <!-- Load the Google Client ID script asynchronously -->
    <script type="text/javascript" src="https://accounts.google.com/gsi/client"></script>

    <script>
      // Replace 'YOUR_API_KEY' with your actual API key
      var API_KEY = "AIzaSyCSssID8r9CL1ImC5Ey14KaL8yE5N0nu2k";

      function initClient() {
        gapi.load("client:auth2", initClientCallback);
      }

      function initClientCallback() {
        gapi.client.init({
          clientId: "GOOGLE_CLIENT_ID",
          scope: ["https://www.googleapis.com/auth/spreadsheets"],
          immediate: true
        }).then(function () {
          authorizeRequest();
        });
      }

      async function authorizeRequest() {
        const tokenResponse = await gapi.client.getToken();
        if (tokenResponse.access_token) {
          loadSheetData();
        } else {
          throw new Error("Access Token Not Found");
        }
      }

      async function loadSheetData() {
        try {
          const sheetResponse = await gapi.client.sheets.spreadsheets.values.get({
            spreadsheetId: "430557343",
            range: "Категории!A1:Z999"
          });

          const rows = sheetResponse.result.values;
          // Process and display the data from the Google Sheet here
          console.log(rows);
        } catch (error) {
          console.error("Error loading sheet data:", error);
        }
      }
    </script>
  </body>
</html>